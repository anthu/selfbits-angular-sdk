!function(n){n.module("selfbitsAngular",["ngResource","ngSanitize"]).run(function(n,e,t){n.domain||e.error('Selfbits SDK: you MUST set $sbApiProvider.domain="yourDomain"'),n.id||e.error('Selfbits SDK: you MUST set $sbApiProvider.appId="yourId"'),n.id&&n.domain||e.error("If you don't have a Selfbits account yet, you can get one at http://baas.selfbits.org"),t.load()})}(angular),function(n){n.module("selfbitsAngular").constant("sbConfig",{id:null,domain:null,secret:null})}(angular),function(n){function e(n,e,t,o,r,i,a,u,s,c){function d(t){var i,d=new o.defer,l=r.gen()+r.gen(),p=n.domain+"/api/v1/oauth/"+t+"?sb_app_id="+n.id+"&sb_app_secret="+n.secret+"&state="+l;if(a.cordova&&a.cordova.InAppBrowser)i=a.cordova.InAppBrowser.open(p,"_blank","location=no"),i.addEventListener("loadstop",function(n){n.url.indexOf(t+"/callback")>-1&&i.close()}),i.addEventListener("loaderror",function(n){n.url.indexOf(t+"/callback")>-1&&i.close()}),i.addEventListener("exit",function(){s(function(){f(t,l).then(function(n){e.setToken(n.data.token),e.setUserId(n.data.userId),c.sync().then(function(){d.resolve(n.data)},function(n){d.reject(n)})},function(n){d.reject(n)})},500)});else{i=a.open(p,"_blank","height=700, width=500");var g=u(function(){i.closed&&(f(t,l).then(function(n){e.setUserId(n.data.userId),e.setToken(n.data.token),d.resolve(n.data)},function(n){d.reject(n)}),u.cancel(g))},1e3)}return d.promise}function f(e,t){return i.get(n.domain+"/api/v1/oauth/"+e+"/token?sb_app_id="+n.id+"&sb_app_secret="+n.secret+"&state="+t)}function l(e){var t=new o.defer;return i["delete"](n.domain+"/api/v1/oauth/"+e+"/unlink").then(function(n){t.resolve(n.data)},function(n){t.reject(n)}),t.promise}function p(e,t){var r=new o.defer;return i.post(n.domain+"/api/v1/auth/password",{newPassword:e,oldPassword:t}).then(function(n){r.resolve(n.data)},function(n){r.reject(n)}),r.promise}function g(t){var r=new o.defer;return i.post(n.domain+"/api/v1/auth/login",t).then(function(n){e.setToken(n.data.token),e.setUserId(n.data.userId),c.sync().then(function(){r.resolve(n.data)},function(n){r.reject(n)})},function(n){r.reject(n)}),r.promise}function v(t){var r=new o.defer;return i.post(n.domain+"/api/v1/auth/signup",t).then(function(n){e.setToken(n.data.token),e.setUserId(n.data.userId),c.sync().then(function(){r.resolve(n.data)},function(n){r.reject(n)})},function(n){r.reject(n)}),r.promise}function m(){e.clear()}function h(){return e.getUserId()}function b(){return null!==e.getToken()}var I={social:d,unlink:l,login:g,signup:v,logout:m,password:p,getUserId:h,isAuthenticated:b};return I}n.module("selfbitsAngular").factory("$sbAuth",e)}(angular),function(n){function e(n,e){function t(t){return e(n.domain+"/api/v1/db/m/"+t+"/:_id",{_id:"@_id"})}var o={table:t};return o}n.module("selfbitsAngular").factory("$sbDatabase",e)}(angular),function(n){function e(n,e,t,o){function r(){var r=new e.defer;return t.cordova&&t.device?o.post(n.domain+"/api/v1/user/device",t.device).then(function(n){r.resolve(n)},function(n){r.reject(n)}):r.resolve(),r.promise}var i={sync:r};return i}n.module("selfbitsAngular").factory("sbDevice",e)}(angular),function(n){function e(){function n(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function e(){return n()+n()+n()+n()+n()+n()+n()+n()}var t={gen:e};return t}n.module("selfbitsAngular").factory("sbGuid",e)}(angular),function(n){function e(n,e,t,o,r,i,a){function u(){return t.device&&t.PushNotification&&f.pushRegistrationData.registrationId?n.post(i.domain+"/api/v1/user/device/notification",{uuid:t.device.uuid,deviceToken:f.pushRegistrationData.registrationId}):void 0}function s(n){t.PushNotification&&(f.push=t.PushNotification.init(n),f.push.on("registration",function(n){f.pushRegistrationData=n}),f.push.on("notification",function(n){o.$broadcast("pushNotificationReceived",n)}),f.push.on("error",function(n){a.log(n)}))}function c(n){var o=e.defer();return t.PushNotification.unregister(function(n){o.resolve(n)},function(n){o.reject(n)},n),o.promise}function d(n){var o=e.defer();return t.PushNotification.setApplicationIconBadgeNumber(function(n){o.resolve(n)},function(n){o.reject(n)},n),o.promise}var f={push:null,pushRegistrationData:null,sync:u,init:s,unregister:c,setBadgeNumber:d};return f}n.module("selfbitsAngular").factory("$sbPush",e)}(angular),function(n){function e(n,e){function t(t){t&&(n.localStorage.setItem("sb_token",t),e.defaults.headers.common.Authorization="Bearer "+t)}function o(e){e&&n.localStorage.setItem("userId",e)}function r(){return n.localStorage.getItem("userId")}function i(){return n.localStorage.getItem("sb_token")}function a(){var t=n.localStorage.getItem("sb_token");t&&(e.defaults.headers.common.Authorization="Bearer "+t)}function u(){e.defaults.headers.common.Authorization=void 0,n.localStorage.clear()}var s={setToken:t,setUserId:o,getToken:i,getUserId:r,load:a,clear:u};return s}n.module("selfbitsAngular").factory("sbState",e)}(angular),function(n){function e(n,e){Object.defineProperties(this,{domain:{get:function(){return e.domain},set:function(n){e.domain=n}},appId:{get:function(){return e.id},set:function(t){e.id=t,n.defaults.headers.common["SB-App-Id"]=t}},appSecret:{get:function(){return e.secret},set:function(t){e.secret=t,n.defaults.headers.common["SB-App-Secret"]=t}}}),this.$get=function(){}}n.module("selfbitsAngular").provider("$sbApi",e)}(angular);